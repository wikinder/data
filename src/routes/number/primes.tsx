export const MAX_PRIME = 65536n;

const PRIME_BITMAP_BASE64 = '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';
const PRIME_BITMAP = Uint8Array.from(atob(PRIME_BITMAP_BASE64), c => c.charCodeAt(0));

export const PRIMES = new Set([2n, 3n]);

let num = 5n;
let step = 2n;

for (const byte of PRIME_BITMAP) {
  for (let mask = 0x80; mask > 0 && num < MAX_PRIME; mask >>= 1) {
    if (byte & mask) {
      PRIMES.add(num);
    }

    num += step;
    step = 6n - step;
  }
}
